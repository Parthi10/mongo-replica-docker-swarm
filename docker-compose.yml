version: "3"
services:

  mongo:
    image: mongo:3.4
    command: mongod --smallfiles --replSet rs1 --dbpath /data/db --nojournal --oplogSize 16 --noauth
    environment:
      TERM: xterm
    labels:
      - "mongo.replica=${NODE}"
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - type: volume
        source: mongodata${NODE}
        target: /data/db
      - type: volume
        source: mongoconfig${NODE}
        target: /data/configdb
    networks:
      - overlay

networks:
  overlay: